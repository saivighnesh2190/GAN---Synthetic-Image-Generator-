# Model Architecture Diagram
## Vanilla GAN for Leaf Disease Image Generation

---

## 1. Complete GAN Architecture

```
                           VANILLA GAN ARCHITECTURE
                           ========================

    ┌─────────────────────────────────────────────────────────────────────┐
    │                          TRAINING LOOP                               │
    │                                                                      │
    │         Real Images                           Fake Images           │
    │        (PlantDoc)                            (Generated)            │
    │             │                                     ▲                  │
    │             │                                     │                  │
    │             ▼                                     │                  │
    │    ┌─────────────────┐                 ┌─────────────────┐          │
    │    │                 │                 │                 │          │
    │    │  DISCRIMINATOR  │◀────compare────▶│    GENERATOR    │          │
    │    │       (D)       │                 │       (G)       │          │
    │    │                 │                 │                 │          │
    │    └────────┬────────┘                 └────────▲────────┘          │
    │             │                                   │                    │
    │             │                                   │                    │
    │             ▼                                   │                    │
    │     Real or Fake?                        Latent Vector z            │
    │         (0-1)                           (100 dimensions)            │
    │                                                                      │
    └─────────────────────────────────────────────────────────────────────┘
```

---

## 2. Generator Network (G)

```
    ┌─────────────────────────────────────────────────────────────────────┐
    │                          GENERATOR (G)                               │
    │                    "Creates Fake Images from Noise"                  │
    └─────────────────────────────────────────────────────────────────────┘

                            INPUT: Latent Vector z
                            ┌───────────────────┐
                            │   z ∈ R^100       │
                            │  (Random Noise)   │
                            └─────────┬─────────┘
                                      │
                                      ▼
                    ┌─────────────────────────────────────┐
                    │    Linear: 100 → 8192 (512×4×4)    │
                    │         Reshape to 3D               │
                    └─────────────────┬───────────────────┘
                                      │
                                      ▼
                            ┌─────────────────┐
                            │   512 × 4 × 4   │
                            └────────┬────────┘
                                     │
                    ┌────────────────┴────────────────┐
                    │  ConvTranspose2d(512→256, 4×4)  │
                    │  BatchNorm → ReLU               │
                    └────────────────┬────────────────┘
                                     │
                            ┌─────────────────┐
                            │   256 × 8 × 8   │
                            └────────┬────────┘
                                     │
                    ┌────────────────┴────────────────┐
                    │  ConvTranspose2d(256→128, 4×4)  │
                    │  BatchNorm → ReLU               │
                    └────────────────┬────────────────┘
                                     │
                            ┌─────────────────┐
                            │  128 × 16 × 16  │
                            └────────┬────────┘
                                     │
                    ┌────────────────┴────────────────┐
                    │  ConvTranspose2d(128→64, 4×4)   │
                    │  BatchNorm → ReLU               │
                    └────────────────┬────────────────┘
                                     │
                            ┌─────────────────┐
                            │   64 × 32 × 32  │
                            └────────┬────────┘
                                     │
                    ┌────────────────┴────────────────┐
                    │  ConvTranspose2d(64→3, 4×4)     │
                    │  Tanh (output range [-1, 1])    │
                    └────────────────┬────────────────┘
                                     │
                                     ▼
                            ┌─────────────────┐
                            │   3 × 64 × 64   │
                            │ (RGB Image)     │
                            └─────────────────┘

                        OUTPUT: Synthetic Leaf Image
```

---

## 3. Discriminator Network (D)

```
    ┌─────────────────────────────────────────────────────────────────────┐
    │                        DISCRIMINATOR (D)                             │
    │                    "Classifies Real vs Fake"                         │
    └─────────────────────────────────────────────────────────────────────┘

                        INPUT: Image (Real or Fake)
                            ┌─────────────────┐
                            │   3 × 64 × 64   │
                            │   (RGB Image)   │
                            └────────┬────────┘
                                     │
                    ┌────────────────┴────────────────┐
                    │     Conv2d(3→64, 4×4, s=2)      │
                    │     LeakyReLU(0.2)              │
                    └────────────────┬────────────────┘
                                     │
                            ┌─────────────────┐
                            │   64 × 32 × 32  │
                            └────────┬────────┘
                                     │
                    ┌────────────────┴────────────────┐
                    │    Conv2d(64→128, 4×4, s=2)     │
                    │    BatchNorm → LeakyReLU(0.2)   │
                    └────────────────┬────────────────┘
                                     │
                            ┌─────────────────┐
                            │  128 × 16 × 16  │
                            └────────┬────────┘
                                     │
                    ┌────────────────┴────────────────┐
                    │    Conv2d(128→256, 4×4, s=2)    │
                    │    BatchNorm → LeakyReLU(0.2)   │
                    └────────────────┬────────────────┘
                                     │
                            ┌─────────────────┐
                            │   256 × 8 × 8   │
                            └────────┬────────┘
                                     │
                    ┌────────────────┴────────────────┐
                    │    Conv2d(256→512, 4×4, s=2)    │
                    │    BatchNorm → LeakyReLU(0.2)   │
                    └────────────────┬────────────────┘
                                     │
                            ┌─────────────────┐
                            │   512 × 4 × 4   │
                            └────────┬────────┘
                                     │
                    ┌────────────────┴────────────────┐
                    │    Flatten → Linear(8192→1)     │
                    │    Sigmoid (output 0-1)         │
                    └────────────────┬────────────────┘
                                     │
                                     ▼
                            ┌─────────────────┐
                            │  Probability    │
                            │  (Real: 1)      │
                            │  (Fake: 0)      │
                            └─────────────────┘

                        OUTPUT: Real/Fake Classification
```

---

## 4. Training Data Flow

```
                           TRAINING DATA FLOW
                           ==================

    ┌─────────────────────────────────────────────────────────────────────┐
    │                                                                      │
    │   PlantDoc Dataset                                                  │
    │   ┌─────────────────────────────────────────────────────────────┐   │
    │   │  Apple Scab │ Tomato Blight │ Corn Rust │ Grape Rot │ ...  │   │
    │   └────────────────────────────────┬────────────────────────────┘   │
    │                                    │                                 │
    │                                    ▼                                 │
    │   ┌─────────────────────────────────────────────────────────────┐   │
    │   │                    PREPROCESSING                             │   │
    │   │  • Resize to 64×64                                          │   │
    │   │  • Normalize to [-1, 1]                                     │   │
    │   │  • Create DataLoader                                        │   │
    │   └────────────────────────────────┬────────────────────────────┘   │
    │                                    │                                 │
    │                                    ▼                                 │
    │                         preprocessed_data/                          │
    │                     ┌─────────────────────────┐                     │
    │                     │  train_data.pt (2342)  │                     │
    │                     │  test_data.pt (236)    │                     │
    │                     └───────────┬─────────────┘                     │
    │                                 │                                    │
    │                                 ▼                                    │
    │                          TRAINING LOOP                              │
    │                                                                      │
    └─────────────────────────────────────────────────────────────────────┘
```

---

## 5. Parameter Summary

```
    ┌─────────────────────────────────────────────────────────────────────┐
    │                      MODEL PARAMETERS                                │
    ├─────────────────────────────────────────────────────────────────────┤
    │                                                                      │
    │   GENERATOR (G)                     DISCRIMINATOR (D)               │
    │   ─────────────                     ─────────────────               │
    │   Linear:      819,200              Conv1:      3,136               │
    │   ConvT1:    2,097,408              Conv2:    131,200               │
    │   ConvT2:      524,416              Conv3:    524,544               │
    │   ConvT3:      131,136              Conv4:  2,097,664               │
    │   ConvT4:       12,291              Linear:     8,193               │
    │   BN layers:    14,848              BN layers:    1,792             │
    │   ─────────────                     ─────────────────               │
    │   TOTAL:     3,600,256              TOTAL:   2,765,569              │
    │                                                                      │
    │                    COMBINED TOTAL: 6,365,825                        │
    │                                                                      │
    └─────────────────────────────────────────────────────────────────────┘
```

---

*Architecture Version: 1.0 | PlantDoc Dataset | January 2026*
